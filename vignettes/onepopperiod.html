<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Working with a single population and transition</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Working with a single population and transition</h1>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">tidy =</span> <span class="ot">TRUE</span>)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(popbio)
<span class="kw">library</span>(popdemo)
<span class="kw">library</span>(raretrans)
<span class="co"># Raymond's theme modifications</span>
rlt_theme &lt;-<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),  
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))</code></pre></div>
<div id="part-i-obtaining-the-projection-matrix-from-popbioprojection_matrix" class="section level1">
<h1>Part I: Obtaining the projection matrix from <code>popbio::projection_matrix</code></h1>
<p>The goal of this vignette is to demonstrate the use of package <code>raretrans</code>, which requires correct data formatting for input into <code>popbio::projection_matrix</code>. Although <code>raretrans</code> can handle multiple populations, here we use only a single population as an example. Obtaining the correct data formatting of the data for <code>popbio::projection_matrix</code> requires us to extract the transition and fertility data for <em>L. elto</em> <strong>POPNUM 250</strong> in <strong>period 5</strong>. We demonstrate this below.</p>
<div id="step-1-load-and-munge-the-single-population-data-for-l.-elto" class="section level2">
<h2>Step 1: Load and munge the single population data for <em>L. elto</em></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;L_elto&quot;</span>) <span class="co"># load the dataset `L_elto` into memory (from package `raretrans`)</span>
<span class="kw">head</span>(L_elto)<span class="co"># ???Perhaps preview the L_elto dataset..???</span></code></pre></div>
<pre><code>## # A tibble: 6 x 15
##   POPNUM  year seedlings adults fertility OCCUORNOT REMOVEDORNOT IND_NUM
##    &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;          &lt;int&gt;
## 1    209     1         1      6         0 Ocupado   No removido       67
## 2    209     2         0      9         0 Ocupado   No removido       67
## 3    209     3         0      9         0 Ocupado   No removido       67
## 4    209     4         0      9         0 Ocupado   No removido       67
## 5    209     1         1      6         0 Ocupado   No removido       68
## 6    209     2         0      9         0 Ocupado   No removido       68
## # … with 7 more variables: stage &lt;chr&gt;, next_stage &lt;chr&gt;,
## #   first_year &lt;dbl&gt;, last_year &lt;dbl&gt;, recruited &lt;lgl&gt;, died &lt;dbl&gt;,
## #   lifespan &lt;int&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">onepop &lt;-<span class="st"> </span>L_elto <span class="op">%&gt;%</span><span class="st">   </span>
<span class="co"># Filter out population # 250, period (year) 5</span>
<span class="st">  </span><span class="kw">filter</span>(POPNUM <span class="op">==</span><span class="st"> </span><span class="dv">250</span>, year <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Define stages (state why we are cahnging p --&gt; s here)</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">stage =</span> <span class="kw">case_when</span>(stage <span class="op">==</span><span class="st"> &quot;p&quot;</span> <span class="op">~</span><span class="st"> &quot;s&quot;</span>,
                           <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>stage),
         <span class="dt">next_stage =</span> <span class="kw">case_when</span>(next_stage <span class="op">==</span><span class="st"> &quot;p&quot;</span><span class="op">~</span><span class="st"> &quot;s&quot;</span>,
                                <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>next_stage))


<span class="co"># popbio::projection.matrix doesn't like tibbles</span>
TF &lt;-<span class="st"> </span>popbio<span class="op">::</span><span class="kw">projection.matrix</span>(<span class="kw">as.data.frame</span>(onepop), 
                        <span class="dt">stage =</span> stage, <span class="dt">fate =</span> next_stage, 
                        <span class="dt">fertility=</span><span class="st">&quot;fertility&quot;</span>, <span class="dt">sort=</span><span class="kw">c</span>(<span class="st">&quot;s&quot;</span>,<span class="st">&quot;j&quot;</span>,<span class="st">&quot;a&quot;</span>), <span class="dt">TF =</span> <span class="ot">TRUE</span>)
TF <span class="co"># This is the stage-structured population model</span></code></pre></div>
<pre><code>## $T
##    
##              s          j          a
##   s 0.09090909 0.00000000 0.00000000
##   j 0.63636364 0.57446809 0.00000000
##   a 0.00000000 0.29787234 0.85294118
## 
## $F
##    
##             s         j         a
##   s 0.0000000 0.0000000 0.1176471
##   j 0.0000000 0.0000000 0.0000000
##   a 0.0000000 0.0000000 0.0000000</code></pre>
<p>Our stages are now coded as <strong>s</strong> (seedling), <strong>j</strong> (juvenile), and <strong>a</strong> (adult), and we now have two matrices: <strong>T</strong> (stage transition) and <strong>F</strong> (fecundity).</p>
</div>
<div id="step-2-obtain-starting-number-of-individuals-per-stage" class="section level2">
<h2>Step 2: Obtain starting number of individuals per stage</h2>
<p>Since our priors are based on counts (number of individuals, <em>N</em>) and the prior equivalent sampling size is expressed as a multiple of the number of individuals observed, we need to obtain the number of individuals in each stage (<span class="math inline">\(N\)</span>) at the first time period.</p>
<p>We use function <code>raretrans::get_state_vector()</code> to obtain the starting individual count, <em>N</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="kw">get_state_vector</span>(onepop, <span class="dt">stage =</span> stage, <span class="dt">sort=</span><span class="kw">c</span>(<span class="st">&quot;s&quot;</span>,<span class="st">&quot;j&quot;</span>,<span class="st">&quot;a&quot;</span>)) 
N <span class="co"># A vector of # of starting individuals for each stage</span></code></pre></div>
<pre><code>## [1] 11 47 34</code></pre>
</div>
<div id="step-3-incorporate-rare-transitions" class="section level2">
<h2>Step 3: Incorporate rare transitions</h2>
<p>The rare transition that is missing from our transition(?) matrix, <code>T</code>, is the transition from seedling (<em>s</em>) to adult (<em>a</em>). In the RLT (DEFINE THIS?) prior, this transitions happens ~ 1% of the time. Therefore, the observed asymptotic population growth rate is <span class="math inline">\(\lambda =\)</span> 0.93.</p>
<p>(JLB – I don’t understand par 69): First, we use a default uniform prior on the transition (<strong>T</strong>), and an uninformative gamma prior on fecundity <strong>F</strong>. We must specify the parameters for the fecundity prior on the non-reproducing stages as <strong>missing</strong>, else the result will fill in the entire matrix. The default for both functions (<code>fill_transitions</code> and <code>fill_fecundity</code>) returns the full matrix <strong>A</strong>, so we need to specify the argument <code>returnType = FALSE</code>, to obtain only the transition and fecundity matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">unif &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">T =</span> <span class="kw">fill_transitions</span>(TF, N, <span class="dt">returnType =</span> <span class="st">&quot;T&quot;</span>), 
             <span class="dt">F =</span> <span class="kw">fill_fecundity</span>(TF, N, 
                                <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="ot">NA_real_</span>, <span class="ot">NA_real_</span>, <span class="fl">1e-05</span>),
                                <span class="dt">beta =</span> <span class="kw">c</span>(<span class="ot">NA_real_</span>, <span class="ot">NA_real_</span>, <span class="fl">1e-05</span>),
                                <span class="dt">returnType =</span> <span class="st">&quot;F&quot;</span>))
unif</code></pre></div>
<pre><code>## $T
##            [,1]        [,2]        [,3]
## [1,] 0.10416667 0.005208333 0.007142857
## [2,] 0.60416667 0.567708333 0.007142857
## [3,] 0.02083333 0.296875000 0.835714286
## 
## $F
##      [,1] [,2]      [,3]
## [1,]    0    0 0.1176473
## [2,]    0    0 0.0000000
## [3,]    0    0 0.0000000</code></pre>
<p>The asymptotic population growth rate is now <span class="math inline">\(\lambda =\)</span> 0.92. The growth rate shrinks slightly because applying the uniform prior to the transition probabilities causes the observed growth and survival transitions to shrink slightly relative to the unobserved transitions.</p>
</div>
<div id="other-options-for-returntype" class="section level2">
<h2>Other options for <code>returnType</code></h2>
<p>There are two other <code>returnType</code>s: 1. <code>fill_transitions()</code> returns an augmented matrix of fates, which is useful for simulation. The fourth row of this result (see below) is the mortality state.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fill_transitions</span>(TF, N, <span class="dt">returnType =</span> <span class="st">&quot;TN&quot;</span>)</code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]
## [1,] 1.25  0.25  0.25
## [2,] 7.25 27.25  0.25
## [3,] 0.25 14.25 29.25
## [4,] 3.25  6.25  5.25</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><code>fill_fecundity()</code> returns the alpha and beta vectors of the posterior.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fill_fecundity</span>(TF, N, 
               <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="ot">NA_real_</span>, <span class="ot">NA_real_</span>, <span class="fl">1e-05</span>),
               <span class="dt">beta =</span> <span class="kw">c</span>(<span class="ot">NA_real_</span>, <span class="ot">NA_real_</span>, <span class="fl">1e-05</span>),
               <span class="dt">returnType =</span> <span class="st">&quot;ab&quot;</span>)</code></pre></div>
<pre><code>## $alpha
##       s       j       a 
##      NA      NA 4.00001 
## 
## $beta
## [1]       NA       NA 34.00001</code></pre>
<p>This demonstrates why the posterior point estimate of fecundity does not change much; the non-informative values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> barely change the observed values.</p>
</div>
</div>
<div id="part-ii-informative-priors" class="section level1">
<h1>Part II: Informative Priors</h1>
<p>We can skip using <code>popbio::projection.matrix()</code> if the matrix is already calculated, and we have the stage vector. We demonstrate this using population 231 in period 2 as an example. We also split the matrix into transition <strong>T</strong> and fecundity <strong>F</strong> matrices.</p>
<div id="step-1-load-and-munge-the-data" class="section level2">
<h2>Step 1: Load and munge the data</h2>
<p>Get population #231 and year (period) 2 from the <code>L_elto</code> data and extract the <strong>T</strong> and <strong>F</strong> matrices.</p>
<pre><code>## $Tmat
##     stage
## fate         p         j         a
##    p 0.5000000 0.0000000 0.0000000
##    j 0.0000000 0.8333333 0.0000000
##    a 0.0000000 0.1666667 0.8750000
## 
## $Fmat
##      [,1] [,2]  [,3]
## [1,]    0    0 0.125
## [2,]    0    0 0.000
## [3,]    0    0 0.000</code></pre>
<p>There were 2, 6, 16 seedlings, juveniles, and adults, respectively, at the start of period 2 for population # 231.</p>
</div>
<div id="step-2-incorporate-informative-priors" class="section level2">
<h2>Step 2: Incorporate informative priors</h2>
<p>This matrix is missing the rare transition from seedling to juvenile. All juveniles survived, which led to an overestimation of survival. So, let’s add a uniform dirichlet prior ???(why dirichlet? maybe a footnote with ref?)??? with weight = <span class="math inline">\(1\)</span> to the transition matrix, <span class="math inline">\(T\)</span>. Here, we have 4 fates (3 + death), so each fate adds 0.25 to the matrix of <em>observed</em> fates (not the transition matrix!). When we specify a prior matrix for the transitions, there is one more row than columns. This extra row represents death.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Tprior &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="fl">0.25</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">nrow=</span><span class="dv">4</span>)
<span class="kw">fill_transitions</span>(TF, N, <span class="dt">P =</span> Tprior) <span class="co"># returns transition matrix by default</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]
## [1,] 0.41666667 0.03571429 0.01470588
## [2,] 0.08333333 0.75000000 0.01470588
## [3,] 0.08333333 0.17857143 0.83823529</code></pre>
<p>We can get the same result ‘by hand’</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Tobs &lt;-<span class="st"> </span><span class="kw">sweep</span>(TF<span class="op">$</span>Tmat,<span class="dv">2</span>,N,<span class="st">&quot;*&quot;</span>) <span class="co"># get the observed transitions</span>
Tobs &lt;-<span class="st"> </span><span class="kw">rbind</span>(Tobs, N <span class="op">-</span><span class="st"> </span><span class="kw">colSums</span>(Tobs)) <span class="co"># add the mortality row</span>
Tobs &lt;-<span class="st"> </span>Tobs <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span> <span class="co"># add the prior</span>
<span class="kw">sweep</span>(Tobs, <span class="dv">2</span>, <span class="kw">colSums</span>(Tobs), <span class="st">&quot;/&quot;</span>)[<span class="op">-</span><span class="dv">4</span>,] <span class="co"># divide by the column sum, and discard mortality</span></code></pre></div>
<pre><code>##            p          j          a
## p 0.41666667 0.03571429 0.01470588
## j 0.08333333 0.75000000 0.01470588
## a 0.08333333 0.17857143 0.83823529</code></pre>
<p>???(This seems out of place?)??? The uniform prior creates problems because it provides transition values that are biologically impossible. For example, it provides a transition for adult-&gt;seedling in teh transition matrix <span class="math inline">\(T\)</span>, when this transition is only possible in the fecundity matrix <span class="math inline">\(F\)</span>. To fix this problem we specify a more informative prior (see <code>RLT_Tprior</code>). It still has to have the same shape, one more row than columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RLT_Tprior &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.025</span>, <span class="fl">0.0</span>,
                       <span class="fl">0.05</span>, <span class="fl">0.9</span>,   <span class="fl">0.025</span>,
                       <span class="fl">0.01</span>, <span class="fl">0.025</span>, <span class="fl">0.95</span>,
                       <span class="fl">0.69</span>, <span class="fl">0.05</span>,  <span class="fl">0.025</span>), 
                     <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</code></pre></div>
<p>This prior is constructed so the columns sum to 1, which creates the greatest flexibility for weighting the prior.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fill_transitions</span>(TF, N, <span class="dt">P =</span> RLT_Tprior)</code></pre></div>
<pre><code>##             [,1]        [,2]        [,3]
## [1,] 0.416666667 0.003571429 0.000000000
## [2,] 0.016666667 0.842857143 0.001470588
## [3,] 0.003333333 0.146428571 0.879411765</code></pre>
<p>We can specify the weight as a multiple of the sample size for each stage.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fill_transitions</span>(TF, N, <span class="dt">P =</span> RLT_Tprior, <span class="dt">priorweight =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>##             [,1]        [,2]        [,3]
## [1,] 0.416666667 0.008333333 0.000000000
## [2,] 0.016666667 0.855555556 0.008333333
## [3,] 0.003333333 0.119444444 0.900000000</code></pre>
<p>Here the prior is weighted half as much as the observed number of transitions, which is larger than 1 but still allows the data to dominate.</p>
</div>
</div>
<div id="part-iii-obtain-credible-intervals" class="section level1">
<h1>Part III: Obtain Credible Intervals</h1>
<div id="obtain-ci-for-indvidual-matrix-entries" class="section level2">
<h2>Obtain CI for indvidual matrix entries</h2>
<p>The marginal posterior distribution of one element in a multinomial is a beta distribution, and we use this to get credible intervals on our transition rates. We can use the TN return type to get the parameters of the desired multinomial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TN &lt;-<span class="st"> </span><span class="kw">fill_transitions</span>(TF, N, <span class="dt">P =</span> RLT_Tprior, <span class="dt">priorweight =</span> <span class="fl">0.5</span>, <span class="dt">returnType =</span> <span class="st">&quot;TN&quot;</span>)
alpha &lt;-<span class="st"> </span>TN[,<span class="dv">1</span>]
beta &lt;-<span class="st"> </span><span class="kw">sum</span>(TN[,<span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span>TN[,<span class="dv">1</span>]
p &lt;-<span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span>(alpha <span class="op">+</span><span class="st"> </span>beta)
lcl &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.025</span>, alpha, beta)
ucl &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.975</span>, alpha, beta)
<span class="kw">sprintf</span>(<span class="st">&quot;%.2f (%.2f, %.2f)&quot;</span>, p, lcl, ucl)</code></pre></div>
<pre><code>## [1] &quot;0.42 (0.03, 0.90)&quot; &quot;0.02 (0.00, 0.20)&quot; &quot;0.00 (0.00, 0.02)&quot;
## [4] &quot;0.56 (0.09, 0.96)&quot;</code></pre>
<p>Those are the point estimates (compare with first column above), lower and upper <span class="math inline">\(95\%\)</span> credible intervals for transitions out of the seedling stage. There is a high degree of uncertainty because of the small sample size (<span class="math inline">\(2\)</span>), and low weight on the prior (<span class="math inline">\(1\)</span>), leading to an effective sample size of 3. If we increase the effective sample size to <span class="math inline">\(20\)</span> by specifying: <code>priorweight</code><span class="math inline">\(= 9 (9*2 = 18 + 2 = 20)\)</span> the credible intervals shrink quite a bit: ???A visual for the credible intervals would be nice???</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TN &lt;-<span class="st"> </span><span class="kw">fill_transitions</span>(TF, N, <span class="dt">P =</span> RLT_Tprior, <span class="dt">priorweight =</span> <span class="dv">9</span>, <span class="dt">returnType =</span> <span class="st">&quot;TN&quot;</span>)
alpha &lt;-<span class="st"> </span>TN[,<span class="dv">1</span>]
beta &lt;-<span class="st"> </span><span class="kw">sum</span>(TN[,<span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span>TN[,<span class="dv">1</span>] <span class="co"># beta parameter is sum of all other dirichlet parameters.</span>
p &lt;-<span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span>(alpha <span class="op">+</span><span class="st"> </span>beta)
lcl &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.025</span>, alpha, beta)
ucl &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.975</span>, alpha, beta)
<span class="kw">sprintf</span>(<span class="st">&quot;%.2f (%.2f, %.2f)&quot;</span>, p, lcl, ucl)</code></pre></div>
<pre><code>## [1] &quot;0.28 (0.11, 0.48)&quot; &quot;0.05 (0.00, 0.17)&quot; &quot;0.01 (0.00, 0.07)&quot;
## [4] &quot;0.67 (0.46, 0.85)&quot;</code></pre>
</div>
<div id="credible-intervals-on-lambda" class="section level2">
<h2>Credible intervals on <span class="math inline">\(\lambda\)</span></h2>
<p>Obtaining credible intervals on the asymptotic growth rate, <span class="math inline">\(\lambda\)</span>, requires simulating matrices from the posterior distributions. This is somewhat complicated to do correctly, and we have written a function <code>raretrans::sim_transitions()</code> to generate a list of simulated matrices given the observed matrix and prior specifications.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sim_transitions</span>(TF, N, <span class="dt">P =</span> RLT_Tprior, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="fl">0.025</span>), <span class="dt">beta =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="dv">1</span>),
                <span class="dt">priorweight =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [[1]]
##              [,1]         [,2]         [,3]
## [1,] 3.414918e-02 4.469410e-09 9.649117e-02
## [2,] 1.214140e-05 9.021448e-01 9.174114e-05
## [3,] 2.246265e-63 2.884682e-02 9.507710e-01</code></pre>
<p>Now we simulate 1000 times, calculate the leading eigenvalue of each matrix, and draw a histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">8390278</span>) <span class="co"># make this part reproducible</span>
RLT_<span class="fl">0.5</span> &lt;-<span class="st"> </span><span class="kw">sim_transitions</span>(TF, N, <span class="dt">P =</span> RLT_Tprior, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="fl">0.025</span>), <span class="dt">beta =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="dv">1</span>),
                <span class="dt">priorweight =</span> <span class="fl">0.5</span>, <span class="dt">samples =</span> <span class="dv">1000</span>)
RLT_<span class="fl">0.5</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">lposterior =</span> <span class="kw">map_dbl</span>(RLT_<span class="fl">0.5</span>, lambda))

<span class="kw">ggplot</span>(<span class="dt">data =</span> RLT_<span class="fl">0.5</span>,
       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> lposterior)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.02</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can calculate some summary statistics too.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RLT_<span class="fl">0.</span>5_summary &lt;-<span class="st"> </span><span class="kw">summarize</span>(RLT_<span class="fl">0.5</span>,
                             <span class="dt">medianL =</span> <span class="kw">median</span>(lposterior),
                             <span class="dt">meanL =</span> <span class="kw">mean</span>(lposterior),
                             <span class="dt">lcl =</span> <span class="kw">quantile</span>(lposterior, <span class="dt">probs =</span> <span class="fl">0.025</span>),
                             <span class="dt">ucl =</span> <span class="kw">quantile</span>(lposterior, <span class="dt">probs =</span> <span class="fl">0.975</span>),
                             <span class="dt">pincrease =</span> <span class="kw">sum</span>(lposterior <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>.)<span class="op">/</span><span class="kw">n</span>())
knitr<span class="op">::</span><span class="kw">kable</span>(RLT_<span class="fl">0.</span>5_summary, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">medianL</th>
<th align="right">meanL</th>
<th align="right">lcl</th>
<th align="right">ucl</th>
<th align="right">pincrease</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.95</td>
<td align="right">0.94</td>
<td align="right">0.83</td>
<td align="right">1</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
